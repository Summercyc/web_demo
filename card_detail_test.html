<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡ç‰‡è¯¦æƒ…å¼¹çª—å¸ƒå±€æµ‹è¯•</title>
    <link rel="stylesheet" href="tailwind.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
            font-family: 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
        }
        
        /* æµ‹è¯•æŒ‰é’® */
        .test-btn {
            background: white;
            color: #667eea;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            margin: 20px auto;
            display: block;
        }
        
        .test-btn:hover {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="text-center mb-8">
        <h1 class="text-white text-2xl font-bold mb-4">å¡ç‰‡è¯¦æƒ…å¼¹çª—å¸ƒå±€æµ‹è¯•</h1>
        <button class="test-btn" onclick="showCardDetail()">ç‚¹å‡»æµ‹è¯•å¡ç‰‡è¯¦æƒ…å¼¹çª—</button>
    </div>

    <script>
        // ä»app.jså¤åˆ¶Markdownè§£æå™¨
        class MarkdownParser {
            static parseMarkdown(text) {
                if (!text) return '';
                
                let html = text
                    // å¤„ç†åˆ†éš”çº¿
                    .replace(/^---+$/gm, '<hr class="my-4 border-gray-300 border-opacity-50">')
                    
                    // å¤„ç†æ ‡é¢˜ï¼ˆ###, ##, #ï¼‰
                    .replace(/^### (.*$)/gm, '<h3 class="text-lg font-semibold text-gray-800 mt-4 mb-2">$1</h3>')
                    .replace(/^## (.*$)/gm, '<h2 class="text-xl font-semibold text-gray-800 mt-5 mb-3">$1</h2>')
                    .replace(/^# (.*$)/gm, '<h1 class="text-2xl font-bold text-gray-800 mt-6 mb-4">$1</h1>')
                    
                    // å¤„ç†ç²—ä½“
                    .replace(/\*\*(.*?)\*\*/g, '<strong class="font-semibold text-gray-800">$1</strong>')
                    
                    // å¤„ç†æ–œä½“
                    .replace(/\*(.*?)\*/g, '<em class="italic text-gray-700">$1</em>')
                    
                    // å¤„ç†è¡¨æƒ…ç¬¦å·å¼€å¤´çš„æ®µè½ï¼ˆç‰¹æ®Šæ ¼å¼ï¼‰
                    .replace(/^(ğŸŒ±|ğŸ§ |ğŸŒ¸|ğŸŒ¼|ğŸ’¡|âš¡|ğŸ¯|ğŸ’­|âœ¨|ğŸ”|ğŸ“|ğŸ’ª|ğŸŒŸ|ğŸª|ğŸ¨|ğŸ“Š|ğŸ†)\s+(.*$)/gm, '<div class="flex items-start mb-3"><span class="text-lg mr-2 mt-1">$1</span><div class="flex-1">$2</div></div>')
                    
                    // å¤„ç†æœ‰åºåˆ—è¡¨
                    .replace(/^\d+\.\s+(.*$)/gm, '<li class="mb-2 ml-4">$1</li>')
                    
                    // å¤„ç†æ— åºåˆ—è¡¨
                    .replace(/^[-\*]\s+(.*$)/gm, '<li class="mb-2 ml-4 relative"><span class="absolute -left-4 text-blue-500">â€¢</span>$1</li>')
                    
                    // å¤„ç†è¡Œå†…ä»£ç 
                    .replace(/`([^`]+)`/g, '<code class="bg-gray-100 px-2 py-1 rounded text-sm font-mono">$1</code>')
                    
                    // å¤„ç†æ¢è¡Œ
                    .replace(/\n\n/g, '</p><p class="mb-3">')
                    .replace(/\n/g, '<br>');
                
                // åŒ…è£…åˆ—è¡¨é¡¹
                html = html.replace(/(<li.*?<\/li>)/gs, function(match, listItems) {
                    if (listItems.includes('ml-4')) {
                        return `<ul class="list-none mb-4">${listItems}</ul>`;
                    }
                    return match;
                });
                
                // åŒ…è£…æ®µè½
                if (!html.includes('<h1>') && !html.includes('<h2>') && !html.includes('<h3>') && !html.includes('<div class="flex')) {
                    html = '<p class="mb-3">' + html + '</p>';
                } else {
                    // å¯¹äºåŒ…å«æ ‡é¢˜çš„å†…å®¹ï¼Œåªåœ¨éæ ‡é¢˜æ®µè½åŠ pæ ‡ç­¾
                    html = html.replace(/^(?!<[h123]|<div|<ul|<hr|<li)(.+)$/gm, '<p class="mb-3">$1</p>');
                }
                
                return html;
            }
            
            static enhanceReflectionContent(text) {
                // ä¸“é—¨ä¸ºå¤ç›˜å†…å®¹ä¼˜åŒ–çš„è§£æ
                let html = this.parseMarkdown(text);
                
                // å¢å¼ºæ ·å¼å¤„ç†
                html = html
                    // ä¸ºè¡ŒåŠ¨è®¡åˆ’æ·»åŠ ç‰¹æ®Šæ ·å¼
                    .replace(/<li([^>]*?)>(.*?(?:è¡ŒåŠ¨|å»ºè®®|è®¡åˆ’|ç›®æ ‡|æ­¥éª¤).*?)<\/li>/gi, 
                        '<li$1><div class="action-item">$2</div></li>')
                    
                    // ä¸ºæ´å¯Ÿå†…å®¹æ·»åŠ é«˜äº®
                    .replace(/<p([^>]*?)>(.*?(?:æ´å¯Ÿ|é¢†æ‚Ÿ|å‘ç°|æ„è¯†åˆ°).*?)<\/p>/gi, 
                        '<div class="highlight">$2</div>')
                    
                    // ç¾åŒ–è¡¨æƒ…ç¬¦å·æ®µè½
                    .replace(/<div class="flex items-start mb-3"><span class="text-lg mr-2 mt-1">(ğŸŒ±|ğŸ§ |ğŸŒ¸|ğŸŒ¼)<\/span><div class="flex-1">(.*?)<\/div><\/div>/g,
                        '<div class="flex items-start mb-4 p-3 bg-white bg-opacity-40 rounded-lg"><span class="text-2xl mr-3">$1</span><div class="flex-1 font-medium">$2</div></div>');
                
                return html;
            }
        }

        function showCardDetail() {
            // æµ‹è¯•æ•°æ®
            const card = {
                title: "**æ·±åº¦å¤ç›˜å¡ç‰‡ï¼šåœ¨å¿™ç¢Œä¸­æ‰¾å›èŠ‚å¥ï¼Œæ¸©æŸ”å¯¹å¾…è‡ªå·±**",
                content: `**æ·±åº¦å¤ç›˜å¡ç‰‡ï¼šä»ç”Ÿæ´»æƒ…ç»ªä¸­æŒ–æ˜åˆ›æ„çµæ„Ÿ**

### ğŸŒ± æ·±åº¦æ´å¯Ÿ
æœ€å¥½çš„äº§å“åˆ›æ„å¾€å¾€æºäºçœŸå®çš„ç”Ÿæ´»ä½“éªŒä¸æƒ…æ„Ÿååº”ï¼Œå°¤å…¶æ˜¯é‚£äº›è®©äººæ„Ÿåˆ°ä¸ä¾¿ã€æƒŠå–œæˆ–è§¦åŠ¨çš„ç¬é—´ã€‚

### ğŸ§  å…³é”®ç‚¹
1. **å…³æ³¨ç”Ÿæ´»ä¸­çš„"æƒ…ç»ªæ—¶åˆ»"**â€”â€”æ— èŠã€æ²®ä¸§ã€æƒŠå–œï¼Œéƒ½æ˜¯åˆ›æ„çš„çº¿ç´¢ã€‚
2. ä»è‡ªå·±æˆ–ä»–äººçš„ç—›ç‚¹å‡ºå‘ï¼Œæ›´å®¹æ˜“æ‰¾åˆ°çœŸå®çš„éœ€æ±‚ã€‚
3. ä¸èº«è¾¹äººäº¤æµï¼Œæ”¶é›†ä»–ä»¬çš„çƒ¦æ¼ä¸æœŸå¾…ï¼Œèƒ½æ¿€å‘æ–°çš„è§†è§’ã€‚

### ğŸŒ¼ è¡ŒåŠ¨å»ºè®®
- å›å¿†æœ€è¿‘ä¸€å‘¨è®©ä½ æœ‰æƒ…ç»ªæ³¢åŠ¨çš„å°äº‹ï¼Œå†™ä¸‹å½“æ—¶çš„æ„Ÿå—ä¸å¯èƒ½çš„æ”¹è¿›æƒ³æ³•ã€‚
- å’Œæœ‹å‹èŠèŠä»–ä»¬çš„æ—¥å¸¸å›°æ‰°ï¼Œè¯•ç€ä»ä¸­å‘ç°å¯ä»¥è§£å†³çš„å°é—®é¢˜ã€‚

**æ„¿ä½ ä»ç”Ÿæ´»çš„ç»†èŠ‚ä¸­ï¼Œæ‰¾åˆ°æ”¹å˜ä¸–ç•Œçš„çµæ„Ÿï¼âœ¨**`,
                tags: ['æ²Ÿé€š', 'å†³ç­–'],
                type: 'quick',
                createdAt: new Date().toISOString()
            };
            
            const cardColor = 'orange';
            
            // åˆ›å»ºæ¨¡æ€æ¡†
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            
            // æ¸…ç†å¡ç‰‡æ ‡é¢˜ä¸­çš„Markdownç¬¦å·
            const cleanTitle = card.title.replace(/\*\*(.*?)\*\*/g, '$1').replace(/\*(.*?)\*/g, '$1').replace(/#+\s*/, '');
            
            modal.innerHTML = `
                <div class="w-[700px] max-w-90vw max-h-[85vh] relative">
                    <!-- ä¸å¯¹è¯éƒ¨åˆ†å®Œå…¨ä¸€è‡´çš„å¤ç›˜å¡ç‰‡ç»“æ„ -->
                    <div class="macaron-card ${cardColor} mb-4">
                        <div class="macaron-title">${cleanTitle}</div>
                        
                        <!-- å¡ç‰‡å…ƒä¿¡æ¯ -->
                        <div class="bg-white bg-opacity-20 backdrop-blur-sm rounded-xl p-4 mb-4">
                            <div class="flex flex-wrap gap-2 items-center justify-between">
                                <div class="flex flex-wrap gap-2">
                                    ${card.tags.map(tag => `
                                        <span class="macaron-tag ${cardColor}">#${tag}</span>
                                    `).join('')}
                                    <span class="macaron-tag ${card.type === 'deep' ? 'purple' : 'orange'}">
                                        ${card.type === 'deep' ? 'ğŸ§  æ·±æ½œ' : 'âš¡ é—ªç”µ'}å¤ç›˜
                                    </span>
                                </div>
                                <span class="text-sm text-white font-medium">${new Date(card.createdAt).toLocaleDateString('zh-CN', { 
                                    year: 'numeric', 
                                    month: 'long', 
                                    day: 'numeric',
                                    weekday: 'long'
                                })}</span>
                            </div>
                        </div>
                        
                        <div class="reflection-card-content">
                            <div class="reflection-content">${MarkdownParser.enhanceReflectionContent(card.content)}</div>
                            
                            <!-- å…³é—­æŒ‰é’®æ”¾åœ¨å†…å®¹å³ä¸‹æ–¹ -->
                            <div class="flex justify-end mt-6">
                                <button class="close-card-detail py-3 px-8 bg-white bg-opacity-90 text-gray-700 rounded-full hover:bg-white hover:shadow-lg transition-all font-medium">
                                    å…³é—­
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // æ·»åŠ åŠ¨ç”»æ•ˆæœ
            setTimeout(() => {
                modal.querySelector('.macaron-card').classList.add('modal-enter');
            }, 10);
            
            // å…³é—­æŒ‰é’®
            modal.querySelector('.close-card-detail').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            // ç‚¹å‡»å¤–éƒ¨å…³é—­
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                }
            });
        }
    </script>
</body>
</html>