<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èƒ½åŠ›é›·è¾¾å›¾åŠŸèƒ½æ¼”ç¤º</title>
    <link rel="stylesheet" href="tailwind.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 40px 20px;
            font-family: 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
        }
        
        .demo-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .demo-btn {
            background: white;
            color: #667eea;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }
        
        .demo-btn:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="text-center mb-8">
            <h1 class="text-white text-3xl font-bold mb-4">ğŸ’« èƒ½åŠ›é›·è¾¾å›¾åŠŸèƒ½æ¼”ç¤º</h1>
            <p class="text-white text-lg mb-6">è¿™æ˜¯ä¸ºæ‚¨çš„æˆé•¿ä»ªè¡¨ç›˜å¼€å‘çš„æ–°åŠŸèƒ½</p>
            <div class="space-x-4">
                <button class="demo-btn" onclick="simulateData()">ğŸ² æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®</button>
                <button class="demo-btn" onclick="showRadarChart()">ğŸ“Š æ˜¾ç¤ºé›·è¾¾å›¾</button>
                <button class="demo-btn" onclick="testInteraction()">ğŸ–±ï¸ æµ‹è¯•äº¤äº’</button>
            </div>
        </div>

        <!-- é›·è¾¾å›¾åŒºåŸŸ -->
        <div class="mb-6">
            <div class="macaron-card blue relative">
                <div class="flex items-center justify-between mb-4">
                    <div class="text-sm text-gray-600">äº”ä¸ªæ ¸å¿ƒè½¯æŠ€èƒ½ç»´åº¦åˆ†æ</div>
                    <div class="relative">
                        <button id="refreshRadarBtn" class="text-blue-500 hover:text-blue-700 text-sm px-3 py-1 border border-blue-300 rounded-full hover:bg-blue-50 transition-all disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent">
                            ğŸ”„ é‡æ–°åˆ†æ
                        </button>
                        <div id="refreshTooltip" class="absolute bottom-full right-0 mb-2 px-3 py-2 bg-gray-800 text-white text-xs rounded-lg opacity-0 pointer-events-none transition-opacity duration-200 whitespace-nowrap z-10">
                            <div class="absolute top-full right-3 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"></div>
                            <span id="tooltipText">åŒæ¨¡å‹æ™ºèƒ½åˆ†æï¼Œç¡®ä¿æœ€ä½³è´¨é‡</span>
                        </div>
                    </div>
                </div>
                <div class="h-80 flex items-center justify-center">
                    <canvas id="competencyRadarChart" class="radar-chart-canvas" width="300" height="300"></canvas>
                </div>
                <div id="radarPlaceholder" class="text-center">
                    <div class="text-4xl mb-3">ğŸ“Š</div>
                    <div class="text-lg mb-1">ç‚¹å‡»"æ¨¡æ‹Ÿæµ‹è¯•æ•°æ®"å¼€å§‹æ¼”ç¤º</div>
                    <div class="text-sm text-gray-500">ç³»ç»Ÿå°†åˆ†ææ‚¨çš„èƒ½åŠ›å‘å±•çŠ¶å†µ</div>
                </div>
            </div>
        </div>
        
        <!-- èƒ½åŠ›è¯¦æƒ…å±•ç¤ºåŒºåŸŸ -->
        <div id="competencyDetailSection" class="mb-6 hidden">
            <div class="macaron-card purple">
                <div class="flex items-center justify-between mb-4">
                    <h5 id="competencyDetailTitle" class="font-semibold text-lg">èƒ½åŠ›è¯¦æƒ…</h5>
                    <button id="closeDetailBtn" class="text-gray-400 hover:text-gray-600 text-xl">&times;</button>
                </div>
                <div id="competencyDetailContent" class="space-y-4">
                    <!-- åŠ¨æ€å†…å®¹å°†åœ¨è¿™é‡Œå¡«å…… -->
                </div>
            </div>
        </div>

        <!-- åŠŸèƒ½è¯´æ˜ -->
        <div class="macaron-card green">
            <h3 class="text-lg font-bold mb-4">ğŸ¯ åŠŸèƒ½ç‰¹æ€§</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                <div>
                    <h4 class="font-semibold mb-2 text-green-700">âœ¨ æ ¸å¿ƒåŠŸèƒ½</h4>
                    <ul class="space-y-1 text-gray-700">
                        <li>â€¢ åŠ¨æ€å±•ç¤ºäº”ä¸ªè½¯æŠ€èƒ½ç»´åº¦</li>
                        <li>â€¢ AI è‡ªåŠ¨åˆ†æå¯¹è¯å’Œå¤ç›˜å†…å®¹</li>
                        <li>â€¢ å®æ—¶æ›´æ–°èƒ½åŠ›è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰</li>
                        <li>â€¢ å¯è§†åŒ–é›·è¾¾å›¾è¡¨å±•ç¤º</li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-2 text-green-700">ğŸ–±ï¸ äº¤äº’ä½“éªŒ</h4>
                    <ul class="space-y-1 text-gray-700">
                        <li>â€¢ ç‚¹å‡»é›·è¾¾å›¾ç»´åº¦æŸ¥çœ‹è¯¦æƒ…</li>
                        <li>â€¢ æ˜¾ç¤ºä¼˜åŠ¿å’Œæ”¹è¿›å»ºè®®</li>
                        <li>â€¢ å±•ç¤ºåˆ†æä¾æ®å’Œæ›´æ–°æ—¶é—´</li>
                        <li>â€¢ æ‰‹åŠ¨è§¦å‘é‡æ–°åˆ†æåŠŸèƒ½</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿåº”ç”¨çŠ¶æ€
        const mockAppState = {
            growthData: {
                competencies: {
                    è¡¨è¾¾åŠ›: { score: 50, analysis: null, lastUpdated: null },
                    å†³ç­–åŠ›: { score: 50, analysis: null, lastUpdated: null },
                    æƒ…ç»ªç®¡ç†: { score: 50, analysis: null, lastUpdated: null },
                    æ‰§è¡ŒåŠ›: { score: 50, analysis: null, lastUpdated: null },
                    è¾¹ç•Œæ„Ÿ: { score: 50, analysis: null, lastUpdated: null }
                }
            },
            reflectionCards: [],
            saveToStorage: () => {
                console.log('æ¼”ç¤ºæ¨¡å¼ï¼šä¿å­˜æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨');
            }
        };

        // æ¨¡æ‹Ÿåº”ç”¨å®ä¾‹
        const mockApp = {
            state: mockAppState,
            callDashScope: async () => { throw new Error('æ¼”ç¤ºæ¨¡å¼ä¸‹ä¸è°ƒç”¨çœŸå®API'); },
            callOpenRouter: async () => { throw new Error('æ¼”ç¤ºæ¨¡å¼ä¸‹ä¸è°ƒç”¨çœŸå®API'); }
        };

        let radarChart = null;

        function simulateData() {
            // æ¨¡æ‹Ÿä¸€äº›å¤ç›˜å¡ç‰‡æ•°æ®
            mockAppState.reflectionCards = [
                { content: "ä»Šå¤©åœ¨ä¼šè®®ä¸Šè¡¨è¾¾è§‚ç‚¹æ—¶...", createdAt: new Date().toISOString() },
                { content: "é¢å¯¹å›¢é˜Ÿå†²çªçš„å¤„ç†...", createdAt: new Date().toISOString() },
                { content: "é¡¹ç›®å†³ç­–çš„å¤ç›˜...", createdAt: new Date().toISOString() }
            ];

            // ç”Ÿæˆæ¨¡æ‹Ÿåˆ†ææ•°æ®
            const mockAnalysis = {
                "è¡¨è¾¾åŠ›": {
                    "score": Math.floor(Math.random() * 30) + 65,
                    "strengths": ["èƒ½å¤Ÿæ¸…æ™°æè¿°é—®é¢˜ç°çŠ¶", "å–„äºç”¨å…·ä½“ä¾‹å­è¯´æ˜è§‚ç‚¹"],
                    "improvements": ["å¯ä»¥æ›´å¤šè¡¨è¾¾å†…å¿ƒæ„Ÿå—", "å°è¯•ç”¨æ›´å¤šå…ƒçš„æ–¹å¼æ²Ÿé€š"],
                    "evidence": "åœ¨æ¼”ç¤ºåœºæ™¯ä¸­è¡¨ç°å‡ºè‰¯å¥½çš„é€»è¾‘è¡¨è¾¾èƒ½åŠ›"
                },
                "å†³ç­–åŠ›": {
                    "score": Math.floor(Math.random() * 30) + 60,
                    "strengths": ["ä¼šè€ƒè™‘å¤šä¸ªè§’åº¦", "æœ‰è‡ªå·±çš„åˆ¤æ–­æ ‡å‡†"],
                    "improvements": ["å¯ä»¥æ›´å¿«é€Ÿåšå‡ºå†³å®š", "å»ºç«‹ç³»ç»Ÿæ€§çš„å†³ç­–æ¡†æ¶"],
                    "evidence": "æ¼”ç¤ºæ—¶æ˜¾ç¤ºå‡ºå¯¹åŠŸèƒ½è§„åˆ’çš„æ€è€ƒèƒ½åŠ›"
                },
                "æƒ…ç»ªç®¡ç†": {
                    "score": Math.floor(Math.random() * 30) + 70,
                    "strengths": ["èƒ½å¤Ÿè¯†åˆ«è‡ªå·±çš„æƒ…ç»ª", "æœ‰å¯»æ±‚å¸®åŠ©çš„æ„è¯†"],
                    "improvements": ["ç»ƒä¹ æƒ…ç»ªè°ƒèŠ‚æŠ€å·§", "æé«˜æƒ…ç»ªå¤åŸåŠ›"],
                    "evidence": "åœ¨åŠŸèƒ½æ¼”ç¤ºä¸­å±•ç°äº†ç¨³å®šçš„æƒ…ç»ªçŠ¶æ€"
                },
                "æ‰§è¡ŒåŠ›": {
                    "score": Math.floor(Math.random() * 30) + 55,
                    "strengths": ["æœ‰åˆ¶å®šè®¡åˆ’çš„ä¹ æƒ¯", "èƒ½å¤Ÿæ€»ç»“ç»éªŒ"],
                    "improvements": ["æé«˜è¡ŒåŠ¨çš„æŒç»­æ€§", "å»ºç«‹æ›´å¥½çš„ç›‘ç£æœºåˆ¶"],
                    "evidence": "é€šè¿‡å®Œæˆé›·è¾¾å›¾åŠŸèƒ½å¼€å‘ä½“ç°å‡ºæ‰§è¡Œèƒ½åŠ›"
                },
                "è¾¹ç•Œæ„Ÿ": {
                    "score": Math.floor(Math.random() * 30) + 60,
                    "strengths": ["å¼€å§‹æ„è¯†åˆ°è¾¹ç•Œçš„é‡è¦æ€§", "èƒ½å¤Ÿåæ€äººé™…å…³ç³»"],
                    "improvements": ["ç»ƒä¹ æ‹’ç»çš„æŠ€å·§", "æ˜ç¡®ä¸ªäººåº•çº¿"],
                    "evidence": "åœ¨åŠŸèƒ½è®¾è®¡ä¸­è€ƒè™‘äº†ç”¨æˆ·ä½“éªŒè¾¹ç•Œ"
                }
            };

            // æ›´æ–°æ¨¡æ‹Ÿæ•°æ®
            const now = new Date().toISOString();
            Object.keys(mockAnalysis).forEach(competency => {
                mockAppState.growthData.competencies[competency] = {
                    score: mockAnalysis[competency].score,
                    analysis: mockAnalysis[competency],
                    lastUpdated: now
                };
            });

            showMessage('âœ… æµ‹è¯•æ•°æ®å·²ç”Ÿæˆï¼ç°åœ¨å¯ä»¥æ˜¾ç¤ºé›·è¾¾å›¾äº†');
        }

        function showRadarChart() {
            if (!radarChart) {
                radarChart = new CompetencyRadarChart('competencyRadarChart', mockApp);
            } else {
                radarChart.renderChart();
            }
            showMessage('ğŸ“Š é›·è¾¾å›¾å·²ç”Ÿæˆï¼ç‚¹å‡»å›¾è¡¨ä¸Šçš„ç»´åº¦æŸ¥çœ‹è¯¦ç»†åˆ†æ');
        }

        function testInteraction() {
            if (!radarChart) {
                showMessage('âš ï¸ è¯·å…ˆæ˜¾ç¤ºé›·è¾¾å›¾');
                return;
            }
            
            // æ¨¡æ‹Ÿç‚¹å‡»ç¬¬ä¸€ä¸ªç»´åº¦
            radarChart.showCompetencyDetail('è¡¨è¾¾åŠ›');
            showMessage('ğŸ–±ï¸ è‡ªåŠ¨å±•ç¤º"è¡¨è¾¾åŠ›"ç»´åº¦è¯¦æƒ…');
        }

        function showMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 3000);
        }

        // ä»app.jså¤åˆ¶CompetencyRadarChartç±»ï¼ˆç®€åŒ–ç‰ˆï¼‰
        class CompetencyRadarChart {
            constructor(canvasId, appInstance) {
                this.canvasId = canvasId;
                this.app = appInstance;
                this.chart = null;
                this.competencyLabels = ['è¡¨è¾¾åŠ›', 'å†³ç­–åŠ›', 'æƒ…ç»ªç®¡ç†', 'æ‰§è¡ŒåŠ›', 'è¾¹ç•Œæ„Ÿ'];
                this.competencyColors = {
                    'è¡¨è¾¾åŠ›': '#FF6B6B',
                    'å†³ç­–åŠ›': '#4ECDC4', 
                    'æƒ…ç»ªç®¡ç†': '#45B7D1',
                    'æ‰§è¡ŒåŠ›': '#96CEB4',
                    'è¾¹ç•Œæ„Ÿ': '#FFEAA7'
                };
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.renderChart();
            }

            setupEventListeners() {
                const refreshBtn = document.getElementById('refreshRadarBtn');
                if (refreshBtn) {
                    refreshBtn.addEventListener('click', () => {
                        if (!refreshBtn.disabled) {
                            showMessage('ğŸš€ å¯åŠ¨åŒæ¨¡å‹æ™ºèƒ½åˆ†æ...');
                            
                            // æ¨¡æ‹ŸåŒæ¨¡å‹åˆ†æè¿‡ç¨‹
                            setTimeout(() => {
                                console.log('ğŸ“Š åŒæ¨¡å‹å¹¶è¡Œåˆ†æç»“æœ:');
                                console.log('  ğŸ“ æ­£åºåˆ†æ: âœ…æˆåŠŸ (2/5 ç»´åº¦)');
                                console.log('  ğŸ“ é€†åºåˆ†æ: âœ…æˆåŠŸ (3/5 ç»´åº¦)');
                                console.log('  ğŸ¯ å¯èåˆç»´åº¦: 5 ä¸ªæ•°æ®æº');
                                console.log('ğŸ”„ å¼€å§‹æ™ºèƒ½æ•´åˆåŒæ¨¡å‹åˆ†æç»“æœ...');
                                console.log('ğŸ“Š æ•°æ®è´¨é‡åˆ†æ: æ­£åº2ä¸ªçœŸå®ç»´åº¦, é€†åº3ä¸ªçœŸå®ç»´åº¦');
                                console.log('ğŸ¯ ä¸¤ä¸ªæ¨¡å‹éƒ½æœ‰çœŸå®æ•°æ®ï¼Œå¼€å§‹æ·±åº¦èåˆåˆ†æ...');
                                console.log('ğŸ“ è¡¨è¾¾åŠ›: è¡¥å……æ­£åºç»“æœ');
                                console.log('ğŸ“ å†³ç­–åŠ›: è¡¥å……æ­£åºç»“æœ');
                                console.log('ğŸ“ æƒ…ç»ªç®¡ç†: è¡¥å……é€†åºç»“æœ');
                                console.log('ğŸ“ æ‰§è¡ŒåŠ›: è¡¥å……é€†åºç»“æœ');
                                console.log('ğŸ“ è¾¹ç•Œæ„Ÿ: è¡¥å……é€†åºç»“æœ');
                                console.log('ğŸ‰ åŒæ¨¡å‹æ·±åº¦èåˆå®Œæˆï¼Œæ‰€æœ‰ç»´åº¦å·²è¡¥å…¨');
                                
                                simulateData();
                                this.renderChart();
                                showMessage('âœ¨ åŒæ¨¡å‹åˆ†æå®Œæˆï¼æ•°æ®å®Œæ•´æ€§å·²ç¡®ä¿');
                            }, 800);
                        }
                    });

                    // æ·»åŠ é¼ æ ‡æ‚¬åœäº‹ä»¶
                    refreshBtn.addEventListener('mouseenter', () => {
                        const tooltip = document.getElementById('refreshTooltip');
                        if (tooltip) {
                            tooltip.classList.remove('opacity-0');
                            tooltip.classList.add('opacity-100');
                        }
                    });

                    refreshBtn.addEventListener('mouseleave', () => {
                        const tooltip = document.getElementById('refreshTooltip');
                        if (tooltip) {
                            tooltip.classList.remove('opacity-100');
                            tooltip.classList.add('opacity-0');
                        }
                    });
                }

                const closeBtn = document.getElementById('closeDetailBtn');
                if (closeBtn) {
                    closeBtn.addEventListener('click', () => {
                        this.hideCompetencyDetail();
                    });
                }
            }

            renderChart() {
                const canvas = document.getElementById(this.canvasId);
                const placeholder = document.getElementById('radarPlaceholder');
                
                if (!canvas || !this.app.state.reflectionCards || this.app.state.reflectionCards.length < 1) {
                    if (canvas) canvas.style.display = 'none';
                    if (placeholder) placeholder.classList.remove('hidden');
                    return;
                }

                if (placeholder) placeholder.classList.add('hidden');
                if (canvas) canvas.style.display = 'block';

                const ctx = canvas.getContext('2d');
                const competencies = this.app.state.growthData.competencies;
                
                const data = {
                    labels: this.competencyLabels,
                    datasets: [{
                        label: 'å½“å‰èƒ½åŠ›æ°´å¹³',
                        data: this.competencyLabels.map(label => competencies[label].score),
                        backgroundColor: 'rgba(52, 152, 219, 0.2)',
                        borderColor: 'rgba(52, 152, 219, 0.8)',
                        borderWidth: 2,
                        pointBackgroundColor: this.competencyLabels.map(label => this.competencyColors[label]),
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                };

                const config = {
                    type: 'radar',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    title: function(context) { return context[0].label; },
                                    label: function(context) { return `åˆ†æ•°: ${context.parsed.r}/100`; }
                                }
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                min: 0,
                                ticks: { stepSize: 20, font: { size: 12 }, color: '#6b7280' },
                                grid: { color: 'rgba(107, 114, 128, 0.2)' },
                                angleLines: { color: 'rgba(107, 114, 128, 0.2)' },
                                pointLabels: { font: { size: 14, weight: 500 }, color: '#374151' }
                            }
                        },
                        interaction: { intersect: false },
                        onClick: (event, elements) => {
                            if (elements.length > 0) {
                                const index = elements[0].index;
                                const competencyName = this.competencyLabels[index];
                                this.showCompetencyDetail(competencyName);
                            }
                        },
                        onHover: (event, elements) => {
                            event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                        }
                    }
                };

                if (this.chart) this.chart.destroy();
                this.chart = new Chart(ctx, config);
            }

            showCompetencyDetail(competencyName) {
                const competency = this.app.state.growthData.competencies[competencyName];
                const detailSection = document.getElementById('competencyDetailSection');
                const detailTitle = document.getElementById('competencyDetailTitle');
                const detailContent = document.getElementById('competencyDetailContent');
                
                if (!competency || !competency.analysis) {
                    showMessage('è¯¥ç»´åº¦æš‚æ— è¯¦ç»†åˆ†æ');
                    return;
                }
                
                const analysis = competency.analysis;
                const color = this.competencyColors[competencyName];
                
                detailTitle.innerHTML = `
                    <span style="color: ${color};">â—</span>
                    ${competencyName} 
                    <span class="text-sm font-normal text-gray-500">(${analysis.score}/100)</span>
                `;
                
                const getScoreClass = (score) => {
                    if (score >= 80) return 'competency-score-excellent';
                    if (score >= 70) return 'competency-score-good';
                    if (score >= 60) return 'competency-score-average';
                    return 'competency-score-needs-improvement';
                };

                detailContent.innerHTML = `
                    <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-4">
                        <h6 class="font-medium text-green-800 mb-3">ğŸŒŸ æ‚¨çš„ä¼˜åŠ¿</h6>
                        <div class="space-y-2">
                            ${analysis.strengths.map(strength => `
                                <div class="competency-strength-item text-sm text-green-700">
                                    ${strength}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mb-4">
                        <h6 class="font-medium text-blue-800 mb-3">ğŸ’¡ æ”¹è¿›å»ºè®®</h6>
                        <div class="space-y-2">
                            ${analysis.improvements.map(improvement => `
                                <div class="competency-improvement-item text-sm text-blue-700">
                                    ${improvement}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 border-l-4 border-gray-400 p-4">
                        <h6 class="font-medium text-gray-700 mb-3">ğŸ“ åˆ†æä¾æ®</h6>
                        <div class="competency-evidence-box text-sm text-gray-600">
                            ${analysis.evidence}
                        </div>
                    </div>
                    
                    <div class="text-xs text-gray-400 mt-4 flex justify-between items-center">
                        <span>æœ€åæ›´æ–°: ${new Date(competency.lastUpdated).toLocaleString('zh-CN')}</span>
                        <span class="competency-score-badge ${getScoreClass(analysis.score)}">
                            ${analysis.score}/100
                        </span>
                    </div>
                `;
                
                detailSection.classList.remove('hidden');
                detailSection.classList.add('competency-detail-card');
                detailSection.scrollIntoView({ behavior: 'smooth' });
            }

            hideCompetencyDetail() {
                const detailSection = document.getElementById('competencyDetailSection');
                if (detailSection) {
                    detailSection.classList.add('hidden');
                }
            }

            parseAIResponse(response) {
                // ç®€åŒ–ç‰ˆçš„AIå“åº”è§£æï¼Œç”¨äºæ¼”ç¤º
                try {
                    return JSON.parse(response);
                } catch (e) {
                    console.log('æ¼”ç¤ºæ¨¡å¼ï¼šJSONè§£æå¤±è´¥ï¼Œè¿”å›null');
                    return null;
                }
            }

            validateAnalysisStructure(data) {
                // ç®€åŒ–ç‰ˆçš„ç»“æ„éªŒè¯ï¼Œç”¨äºæ¼”ç¤º
                if (!data || typeof data !== 'object') return false;
                const required = ['è¡¨è¾¾åŠ›', 'å†³ç­–åŠ›', 'æƒ…ç»ªç®¡ç†', 'æ‰§è¡ŒåŠ›', 'è¾¹ç•Œæ„Ÿ'];
                return required.every(comp => data[comp] && typeof data[comp].score === 'number');
            }
        }
    </script>
</body>
</html>